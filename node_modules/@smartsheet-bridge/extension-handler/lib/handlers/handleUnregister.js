"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handleUnregister = exports.PLUGIN_UNREGISTER = void 0;
exports.PLUGIN_UNREGISTER = 'PLUGIN_UNREGISTER';
const isUnregisterPayload = (payload) => payload.event === exports.PLUGIN_UNREGISTER;
exports.handleUnregister = (config) => create => () => {
    const next = create();
    return (body, callback) => {
        if (isUnregisterPayload(body) &&
            typeof config.onUnregister === 'function') {
            const settings = (body.payload && body.payload.registrationData) || {};
            const { caller } = body;
            const { externalURI, inboundURI, webhookURI, providerOAuth } = body.payload || {};
            next(config.onUnregister(settings, {
                caller,
                externalURI,
                inboundURI,
                webhookURI,
                settings,
                oAuthData: providerOAuth,
            }), callback);
        }
        else {
            next(body, callback);
        }
    };
};
//# sourceMappingURL=handleUnregister.js.map