"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createBridgeService = void 0;
const bridge_sdk_1 = require("@smartsheet-bridge/bridge-sdk");
const extension_cli_logger_1 = require("@smartsheet-bridge/extension-cli-logger");
exports.createBridgeService = (host, auth) => {
    const debugRequest = extension_cli_logger_1.Logger.debug('API Request');
    const debugResponse = extension_cli_logger_1.Logger.debug('API Response');
    const { accountName, hostName, protocol } = bridge_sdk_1.parseAccountURL(host);
    const http = bridge_sdk_1.createHTTPClient({
        baseURL: `${protocol}://${accountName}.${hostName}/api/`,
        token: auth,
    });
    http.instance.interceptors.request.use(request => {
        extension_cli_logger_1.Logger.verbose('API Request', extension_cli_logger_1.Chalk.cyan(`${request.baseURL}${request.url}`));
        debugRequest('Headers', request.headers);
        debugRequest('Params', request.params);
        debugRequest('Data', request.data);
        return request;
    });
    http.instance.interceptors.response.use(response => {
        extension_cli_logger_1.Logger.verbose('API Response', extension_cli_logger_1.Chalk.cyan(`${response.status} ${response.statusText}`));
        debugResponse('Status', response.status);
        debugResponse('Headers', response.headers);
        debugResponse('Data', response.data);
        return response;
    });
    return http;
};
//# sourceMappingURL=bridgeService.js.map